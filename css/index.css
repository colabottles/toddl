/* ====================================
   FIXES AND MODERN RESETS
   ==================================== */

/* 1. FIXED: Adopt the modern border-box model for intuitive sizing */
html {
  /* Set box-sizing on HTML so all descendants inherit it */
  box-sizing: border-box;
  scroll-behavior: smooth;
  font-size: var(--font-size);
  line-height: var(--line-height);
  font-family: var(--font-family-sans);
  background-color: var(--dark);
  color: var(--white)
}

/* Inherit box-sizing globally, including for ::before and ::after pseudo-elements */
*,
*::before,
*::after {
  box-sizing: inherit;
  font: inherit; /* Keep font inheritance here */
}

/* 2. Standard Reset (Consolidated) */
a, abbr, address, article, aside, audio, blockquote, body, canvas, caption, cite, code, dd, del, details, dfn, div, dl, dt, em, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, iframe, img, ins, label, legend, li, main, mark, nav, ol, p, pre, q, section, small, span, strike, strong, sub, summary, sup, table, tbody, td, tfoot, th, thead, time, tr, ul, video {
  margin: 0;
  padding: 0;
  border: 0
}

li, ol, ul {
  margin: 0;
  padding: 0
}

table {
  border-collapse: collapse;
  border-spacing: 0
}

q {
  quotes: none
}

q:after, q:before {
  content: "";
  content: none
}

/* ====================================
   GLOBAL STYLES AND VARIABLES
   ==================================== */

:root {
  --black: #000;
  --white: #fff;
  --grey: gray;
  --green: #4a7a00;
  --ecto: #a3af7c;
  /* --dark: #232323; */
  --dark: #333;
  --night: #555;
  --font-family-sans: 'Work Sans', Arial, Helvetica, sans-serif;
  --font-family-serif: Georgia, 'Times New Roman', serif;
  --font-family-heading-sm: 'Work Sans', Arial, Helvetica, sans-serif;
  --font-family-mono: 'Cascadia Code', monospace;
  --font-weight-bolder: 900;
  --font-size: 140%;
  --line-height: 1.5;
  --line-height-heading: 1;
  --inset: .5rem;
  --large: 1100px;
  --medium: 960px;
  --small: 515px;
  /* Add missing font-size variables for consistency if needed, e.g. */
  --font-size-xsmall: 0.75rem; 
  --font-size-small: 0.83rem; 
  --font-size-article: 1rem; 
  --font-size-large: 1.17rem; 
  --font-size-xlarge: 1.5rem; 
  --font-size-xxlarge: 2rem; 
}

/* 3. FIXED: Uncommented and defined all heading sizes */
h1 {font-size: 2rem;}
h2 {font-size: 1.5rem;}
h3 {font-size: 1.17rem;}
h4 {font-size: 1rem;}
h5 {font-size: .83rem;}
h6 {font-size: .67rem;}

@font-face {
  src: url("../fonts/WorkSans.woff2") format("woff2");
  font-display: swap;
  font-family: 'Work Sans';
  font-style: normal;
  font-weight: 100 900;
}

/* Image and Media Styles */
img, video, iframe {
  max-inline-size: 100%;
  block-size: auto;
  object-fit: contain
}

img:not([alt]) {
  filter: blur(5px);
  border: 5px solid red
}

iframe, video {
  aspect-ratio: 16/9;
  height: auto;
  max-width: 100vmin
}

figure {
  display: grid;
  place-self: center
}

iframe {
  display: grid;
  justify-self: center
}

img.lazyload {
  object-fit: cover
}

/* Link Styles */
a, a:visited {
  color: inherit
}

a:focus {
  outline: 2px solid #8cc63f
}

a {
  text-decoration: none
}

a[href] {
  color: var(--ecto)
}

a[href]:hover {
  color: var(--white);
  -webkit-transition: all .2s ease-in-out;
  -moz-transition: all .2s ease-in-out;
  transition: all .2s ease-in-out;
  text-decoration: underline
}

/* Utility Classes */
[hidden] {
  display: none !important
}

[disabled] {
  cursor: not-allowed
}

.sr-only {
  position: absolute;
  clip: rect(1px, 1px, 1px, 1px);
  left: -9999px;
  top: -9999px
}

.visible-hidden {
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1.5em 0 0 0;
  overflow: hidden;
  justify-self: center;
  position: absolute;
  white-space: nowrap;
  width: 1px
}

.visible-hidden:focus {
  clip: auto;
  height: auto;
  overflow: auto;
  position: absolute;
  width: auto
}

strong {
  font-weight: var(--font-weight-bolder)
}

p {
  margin-block: 1lh;
}

p+p, p~p {
  padding: .25em
}

/* Base Grid/Flex Display for Semantic Elements */
article, aside, footer, header, main, nav, section {
  display: grid
}

/* ====================================
   LAYOUT: WRAPPER AND GRID
   ==================================== */

/* Full grid with minmax for fluid/centered large content */
.wrapper {
  display: grid;
  grid-template-columns: [full-start] minmax(calc(calc(100% - var(--large))/2), 1fr) [main-start] repeat(10, [col-start] 1fr) [main-end] minmax(calc(calc(100% - var(--large))/2), 1fr) [full-end]
}

/* Main and Inner should use subgrid or inherit the wrapper's structure */
main {
  grid-template-columns: subgrid;
  grid-column: full
}

@supports (display:grid) {
  main {
    grid-template-columns: [full-start] minmax(calc(calc(100% - var(--large))/2), 1fr) [main-start] repeat(10, [col-start] 1fr) [main-end] minmax(calc(calc(100% - var(--large))/2), 1fr) [full-end];
    grid-column: full
  }
}

.inner {
  display: grid;
  grid-template-columns: [full-start] minmax(calc(calc(100% - var(--large))/2), 1fr) [main-start] repeat(10, [col-start] 1fr) [main-end] minmax(calc(calc(100% - var(--large))/2), 1fr) [full-end]
}

/* Standard content column span */
.about-container, .about-intro, .article-container, .blogroll-container, .page-container, .uses-links, section.article__body, article.archive-list {
  grid-column: 2/12
}

/* ====================================
   RESPONSIVE LAYOUTS (Media Queries)
   ==================================== */

@media only screen and (max-width: 960px) {
  /* Reduce fixed max width for better centering on medium screens */
  .wrapper, main {
    grid-template-columns: [full-start] minmax(calc(calc(100% - 960px)/2), 1fr) [main-start] repeat(10, [col-start] 1fr) [main-end] minmax(calc(calc(100% - 960px)/2), 1fr) [full-end];
  }

  main {
    grid-column: full;
    padding-top: 5em
  }

  header {
    margin: 3vh 0 6vh;
    grid-column: 1/10;
    align-items: baseline;
    display: flex;
    flex-wrap: wrap
  }

  .copyright, footer, .sections, .article {
    grid-column: 2/10
  }
}

/* 4. FIXED: Mobile Layout (max-width: 540px)
   Simplified to a single column grid with fluid width (1fr)
   The invalid 'calc(calc(100% - 540px)/2)' calculation is removed.
*/
@media only screen and (max-width: 540px) {
  .wrapper, main, .inner {
    display: grid;
    /* Sets up a single, full-width column */
    grid-template-columns: 1fr;
    /* Optional: Adds uniform side padding/gutters to the container itself */
    padding-inline: var(--inset, 0.5rem); 
    grid-column: auto; /* Ensure this is not overriding the new 1fr grid */
  }

  /* Force all main content elements to span the single column */
  header,
  .articles,
  article,
  .page-container,
  .about-container,
  .about-intro,
  .article-container,
  .blogroll-container,
  .uses-links,
  section.article__body,
  article.archive-list,
  .sections,
  .copyright,
  footer,
  .contact,
  .post__likes {
    grid-column: 1 / -1; /* Span from the first line to the last line */
    width: auto; /* Remove explicit width constraints */
    margin-right: 0;
  }

  /* Adjustments for nested elements */
  ul.navigation {
    display: flex;
    padding: 0;
    min-width: 100%; /* Use 100% instead of 100vw to stay within wrapper's bounds */
    justify-content: space-around;
  }

  .article-container,
  .article__header,
  .article__title {
    width: auto; /* Reset explicit widths */
    grid-column: 1 / -1; /* Ensure they span the single column */
  }
  
  section.article__body ol,
  section.article__body ul {
    margin-left: 1rem; /* Reduce margin on small screen */
    padding: 1rem 0
  }
  
  ul.event-list, ul.event-past, ul.podcast-list {
    margin-left: 0.5em
  }

  /* Other mobile-specific overrides (Kept from original code) */
  header {
    margin: 1vh 0 2vh;
  }

  p+p {
    margin-top: 1em
  }
  
  ul.navigation a {
    padding: 0 1rem;
    text-decoration: underline
  }

  .main-nav li {
    padding: 0
  }

  main h2 {
    font-size: var(--font-size-xlarge);
    line-height: var(--line-height-small);
    padding: 2rem 0
  }
}